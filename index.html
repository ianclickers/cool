<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Ian Clicker</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Orbitron', sans-serif;
      margin: 0;
      display: flex;
      height: 100vh;
      overflow: hidden;
    }
    .left, .right {
      flex: 1;
      padding: 20px;
      box-sizing: border-box;
    }
    .left {
      background-color: #e0f7fa;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }
    .right {
      background-color: #f1f8e9;
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    .world2.left {
      background-color: #ffebee;
    }
    .world2.right {
      background-color: #fce4ec;
    }
    #clicker-img {
      width: 200px;
      height: 200px;
      border-radius: 50%;
      border: 5px solid #444;
      cursor: pointer;
      transition: transform 0.1s;
    }
    #clicker-img:active {
      transform: scale(0.95);
    }
    #counter {
      margin-top: 20px;
      font-size: 28px;
    }
    button {
      padding: 12px 18px;
      font-size: 18px;
      cursor: pointer;
      border: none;
      color: white;
      transition: background-color 0.3s;
    }
    button:disabled {
      cursor: not-allowed;
      color: #ccc;
    }
    .upgrade {
      background-color: #4caf50;
    }
    .upgrade.world2 {
      background-color: #e53935;
    }
    #rebirth-btn {
      background-color: #f44336;
    }
    #rebirth-btn:disabled {
      background-color: grey;
    }
  </style>
</head>
<body>
  <div class="left world1">
    <img id="clicker-img" src="ian.png" alt="Ian">
    <div id="counter">Clicks: 0</div>
    <div id="rebirths">Rebirths: 0</div>
    <div id="world">World: 1</div>
    <button id="rebirth-btn" onclick="rebirth()">Rebirth</button>
  </div>

  <div class="right world1">
    <button class="upgrade world1" id="upgrade-1" onclick="buyUpgrade(1)">Buy Auto Clicker (+2)</button>
    <button class="upgrade world1" id="upgrade-2" onclick="buyUpgrade(2)">Buy Ian Factory (+15)</button>
    <button class="upgrade world1" id="upgrade-3" onclick="buyUpgrade(3)">Buy Ian AI (+30)</button>
  </div>

  <script>
    let clicks = parseInt(localStorage.getItem("clicks")) || 0;
    let upgrades = JSON.parse(localStorage.getItem("upgrades")) || { 1: 0, 2: 0, 3: 0 };
    let lastSaved = parseInt(localStorage.getItem("lastSaved")) || Date.now();
    let rebirths = Math.min(parseInt(localStorage.getItem("rebirths")) || 0, 1000);
    let world = parseInt(localStorage.getItem("world")) || 1;
    let buyMultiplier = 1;

    const counter = document.getElementById("counter");
    const rebirthDisplay = document.getElementById("rebirths");
    const worldDisplay = document.getElementById("world");
    const rebirthBtn = document.getElementById("rebirth-btn");
    const upgradeButtons = document.querySelectorAll(".upgrade");
    const img = document.getElementById("clicker-img");
    const buyControls = document.createElement('div');

    buyControls.innerHTML = `
      <label style="font-weight: bold;">Buy x:</label>
      <select id="buy-multiplier" style="margin-left: 10px; padding: 4px;">
        <option value="1">1x</option>
        <option value="5">5x</option>
        <option value="10">10x</option>
        <option value="20">20x</option>
      </select>
    `;
    document.querySelector(".right").prepend(buyControls);
    document.getElementById("buy-multiplier").addEventListener("change", (e) => {
      buyMultiplier = parseInt(e.target.value);
      updateDisplay();
    });

    function updateDisplay() {
      counter.textContent = `Clicks: ${Math.floor(clicks)}`;
      rebirthDisplay.textContent = `Rebirths: ${rebirths}`;
      worldDisplay.textContent = `World: ${world}`;

      rebirthBtn.disabled = clicks < 100000;
      rebirthBtn.style.backgroundColor = clicks >= 100000 ? "#f44336" : "grey";

      [1, 2, 3].forEach(type => {
        const btn = document.querySelector(`#upgrade-${type}`);
        const cost = getUpgradeCost(type, buyMultiplier);
        if (clicks >= cost) {
          btn.disabled = false;
          btn.style.backgroundColor = world === 2 ? "#e53935" : "#4caf50";
        } else {
          btn.disabled = true;
          btn.style.backgroundColor = "grey";
        }
        btn.textContent = `${getUpgradeName(type)} (x${buyMultiplier}) - ${cost} clicks`;
      });

      if (clicks >= 1000000 && world === 1) {
        world = 2;
        localStorage.setItem("world", world);
        applyTheme();
        alert("ðŸŒ You've unlocked World 2! Everything is now RED.");
      }
    }

    function getUpgradeName(type) {
      return {
        1: "Buy Auto Clicker (+2)",
        2: "Buy Ian Factory (+15)",
        3: "Buy Ian AI (+30)"
      }[type];
    }

    function getUpgradeCost(type, mult) {
      const baseCosts = { 1: 10, 2: 100, 3: 500 };
      return baseCosts[type] * mult;
    }

    function buyUpgrade(type) {
      const cost = getUpgradeCost(type, buyMultiplier);
      if (clicks >= cost) {
        clicks -= cost;
        upgrades[type] += buyMultiplier;
        updateDisplay();
        saveGame();
      }
    }

    function saveGame() {
      localStorage.setItem("clicks", clicks);
      localStorage.setItem("upgrades", JSON.stringify(upgrades));
      localStorage.setItem("lastSaved", Date.now());
      localStorage.setItem("rebirths", rebirths);
      localStorage.setItem("world", world);
    }

    function getFarmRate() {
      const base = upgrades[1] * 2 + upgrades[2] * 15 + upgrades[3] * 30;
      return base * (1 + rebirths * 0.5);
    }

    function applyAutoClicks() {
      let total = getFarmRate();
      let added = 0;
      const step = setInterval(() => {
        if (added >= total) {
          clearInterval(step);
        } else {
          clicks++;
          added++;
          updateDisplay();
        }
      }, 5);
    }

    function applyOfflineProgress() {
      const now = Date.now();
      const seconds = Math.floor((now - lastSaved) / 1000);
      const earned = getFarmRate() * seconds;
      if (earned > 0) {
        clicks += earned;
        alert(`You earned ${Math.floor(earned)} clicks while away!`);
      }
    }

    function rebirth() {
      if (clicks >= 100000 && rebirths < 1000) {
        if (confirm(`Rebirth will reset clicks and upgrades, but make auto farming faster (x${1 + (rebirths + 1) * 0.5})! Proceed?`)) {
          clicks = 0;
          upgrades = { 1: 0, 2: 0, 3: 0 };
          rebirths++;
          updateDisplay();
          saveGame();
        }
      }
    }

    img.addEventListener("click", () => {
      clicks++;
      updateDisplay();
      saveGame();
    });

    function applyTheme() {
      const theme = world === 2 ? 'world2' : 'world1';
      const other = world === 2 ? 'world1' : 'world2';

      document.body.classList.remove(other);
      document.querySelector('.left').classList.remove(other);
      document.querySelector('.right').classList.remove(other);
      img.classList.remove(other);
      rebirthBtn.classList.remove(other);
      upgradeButtons.forEach(btn => btn.classList.remove(other));

      document.body.classList.add(theme);
      document.querySelector('.left').classList.add(theme);
      document.querySelector('.right').classList.add(theme);
      img.classList.add(theme);
      rebirthBtn.classList.add(theme);
      upgradeButtons.forEach(btn => btn.classList.add(theme));
    }

    applyOfflineProgress();
    applyTheme();
    updateDisplay();
    setInterval(applyAutoClicks, 1000);
  </script>
</body>
</html>
